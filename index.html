<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
<title>Game Night | The Dart Room</title>

<style>
:root {
  --bg0: #050a12;
  --bg1: #071423;
  --bg2: #0b1a2e;

  --text: #eaf2ff;
  --muted: #8ba2c0;

  /* More color (arcade/sport blend, not rainbow chaos) */
  --accent: #59b2ff;         /* electric blue */
  --accent2: #9b6bff;        /* neon purple */
  --accent3: #ff4bd8;        /* neon pink */
  --accent4: #ffd166;        /* warm gold */
  --success: #2bd576;
  --danger: #ff4d5a;

  --accent-glow: rgba(89, 178, 255, 0.34);
  --accent2-glow: rgba(155, 107, 255, 0.30);
  --accent3-glow: rgba(255, 75, 216, 0.26);

  --glass: rgba(255, 255, 255, 0.07);
  --glass2: rgba(255, 255, 255, 0.025);
  --glass-border: rgba(255, 255, 255, 0.14);

  --shadow0: rgba(0,0,0,0.35);
  --shadow1: rgba(0,0,0,0.60);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html, body { height: 100%; margin: 0; background: var(--bg0); }

body {
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  color: var(--text);

  /* richer, more colorful background */
  background:
    radial-gradient(900px 520px at 18% -10%, rgba(255, 75, 216, 0.35) 0%, rgba(255, 75, 216, 0.00) 55%),
    radial-gradient(1000px 600px at 78% 0%, rgba(89, 178, 255, 0.45) 0%, rgba(89, 178, 255, 0.00) 60%),
    radial-gradient(1100px 700px at 50% 10%, rgba(155, 107, 255, 0.30) 0%, rgba(155, 107, 255, 0.00) 60%),
    linear-gradient(180deg, var(--bg1), var(--bg0));
  background-attachment: fixed;
  overflow-x: hidden;
}

/* Enhanced Texture Overlay */
body::before {
  content: ""; position: fixed; inset: 0; pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
  mix-blend-mode: overlay; z-index: 1;
}

/* subtle vignette */
body::after{
  content:""; position:fixed; inset:-40px; pointer-events:none; z-index:1;
  background:
    radial-gradient(900px 520px at 50% 10%, rgba(0,0,0,0.00) 0%, rgba(0,0,0,0.40) 75%, rgba(0,0,0,0.70) 100%);
}

.topbar {
  position: sticky; top: 0; z-index: 100;
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 18px; background: rgba(5, 13, 24, 0.82);
  backdrop-filter: blur(20px); border-bottom: 1px solid var(--glass-border);
  box-shadow: 0 10px 30px rgba(0,0,0,0.35);
}

.brand { display:flex; flex-direction:column; gap:2px; line-height:1.05; }
.brand .t {
  font-weight: 950;
  font-size: 18px;
  letter-spacing: -0.8px;

  /* chrome / bevel-ish title */
  background: linear-gradient(90deg, #ffffff 0%, #bfe6ff 22%, #ffffff 45%, #e6d6ff 65%, #ffffff 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;

  text-shadow:
    0 2px 0 rgba(0,0,0,0.55),
    0 0 18px var(--accent-glow),
    0 0 26px var(--accent2-glow);
}
.brand .s {
  font-size: 10px;
  text-transform: uppercase;
  color: var(--muted);
  letter-spacing: 1px;
  font-weight: 650;
}

.wrap {
  max-width: 980px;
  margin: 0 auto;
  padding: 16px;
  position: relative;
  z-index: 2;
}

/* Cards */
.card {
  background: linear-gradient(145deg, var(--glass), var(--glass2));
  backdrop-filter: blur(16px);
  border: 1px solid var(--glass-border);
  border-radius: 26px;
  padding: 18px;
  margin-bottom: 14px;
  box-shadow: 0 18px 40px rgba(0,0,0,0.26);
}

.h1 {
  font-size: 28px;
  font-weight: 900;
  margin: 0 0 6px;
  letter-spacing: -0.6px;
}
.sub { color: var(--muted); font-size: 14px; font-weight: 600; }

/* Bevel / embossed utility */
.emboss {
  text-shadow:
    0 2px 0 rgba(0,0,0,0.55),
    0 0 14px rgba(255,255,255,0.06);
}

/* Gradient header text */
.gradText {
  background: linear-gradient(90deg, var(--accent) 0%, var(--accent2) 35%, var(--accent3) 70%, var(--accent4) 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 0 2px 0 rgba(0,0,0,0.60);
}

/* Buttons */
.btn {
  border-radius: 16px;
  padding: 12px 16px;
  font-weight: 850;
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.14);
  display: inline-flex; align-items: center; justify-content: center;
  font-size: 14px;
  transition: transform 0.12s ease, box-shadow 0.2s ease, border-color 0.2s ease, background 0.2s ease;
  box-shadow: 0 10px 20px rgba(0,0,0,0.18);
}
.btn:active { transform: scale(0.97); }

.btn.ok {
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent2) 55%, var(--accent3) 110%);
  color: #050a12;
  border: none;
  box-shadow: 0 8px 22px var(--accent-glow), 0 10px 28px var(--accent2-glow);
}
.btn.ok:hover { filter: brightness(1.03); }

.btn.ghost {
  background: rgba(255,255,255,0.06);
  color: var(--text);
  border-color: var(--glass-border);
}
.btn.ghost:hover {
  border-color: rgba(255,255,255,0.22);
  box-shadow: 0 12px 26px rgba(0,0,0,0.22);
}

.btn.danger {
  background: rgba(255,77,90,0.13);
  color: var(--danger);
  border-color: rgba(255,77,90,0.28);
}
.btn.danger:hover { box-shadow: 0 12px 26px rgba(255,77,90,0.10); }

/* Game grid */
.gameGrid, .rosterGrid { display: grid; grid-template-columns: 1fr; gap: 14px; }
@media(min-width: 768px) { .gameGrid, .rosterGrid { grid-template-columns: 1fr 1fr; } }

.gameCard {
  background: linear-gradient(145deg, rgba(255,255,255,0.07), rgba(255,255,255,0.02));
  border-radius: 22px;
  padding: 16px;
  border: 1px solid var(--glass-border);
  transition: transform 0.22s ease, border-color 0.22s ease, box-shadow 0.22s ease;
}
.gameCard:hover {
  transform: translateY(-4px);
  border-color: rgba(89,178,255,0.55);
  box-shadow: 0 18px 38px rgba(0,0,0,0.32);
}

/* Pills */
.pill {
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 950;
  letter-spacing: 0.8px;
  background: linear-gradient(135deg, rgba(89,178,255,0.20), rgba(155,107,255,0.16));
  color: #d9f0ff;
  text-transform: uppercase;
  border: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 10px 18px rgba(0,0,0,0.18);
}
.pill .dot {
  width:9px; height:9px; border-radius:50%;
  background: var(--success);
  box-shadow: 0 0 12px rgba(43,213,118,0.45);
}

/* Inputs */
input {
  width: 100%;
  background: rgba(0,0,0,0.35);
  border: 1px solid var(--glass-border);
  border-radius: 14px;
  padding: 14px 14px;
  color: #fff;
  font-size: 16px;
  outline: none;
  margin-top: 10px;
  transition: border-color 0.2s, box-shadow 0.2s;
}
input:focus {
  border-color: rgba(89,178,255,0.75);
  box-shadow: 0 0 0 3px rgba(89,178,255,0.16), 0 0 22px var(--accent-glow);
}

/* Dartboard highlight */
@keyframes hotPulse {
  0%, 100% { opacity: 0.35; filter: brightness(1); }
  50% { opacity: 1; filter: brightness(1.6); }
}
.hotWedge {
  animation: hotPulse 1.2s infinite ease-in-out;
  filter: drop-shadow(0 0 10px var(--accent));
}

/* Hit buttons */
.hitRow { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 14px; }
.hitBtn {
  flex: 1;
  min-width: 120px;
  padding: 16px;
  border-radius: 18px;
  font-weight: 950;
  background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
  border: 1px solid var(--glass-border);
  color: #fff;
  transition: transform 0.12s ease, box-shadow 0.2s ease, border-color 0.2s ease, filter 0.2s ease;
  cursor: pointer;
  box-shadow: 0 14px 24px rgba(0,0,0,0.22);
}
.hitBtn:hover {
  border-color: rgba(89,178,255,0.55);
  box-shadow: 0 16px 30px rgba(0,0,0,0.28), 0 0 18px rgba(89,178,255,0.12);
}
.hitBtn:active { transform: translateY(1px) scale(0.99); }

.hitBtn.miss {
  background: linear-gradient(180deg, rgba(255,77,90,0.16), rgba(255,77,90,0.06));
  border-color: rgba(255,77,90,0.30);
  color: #ffd3d7;
}

/* --- PLAY HEADER / TURN VISIBILITY --- */
.playHeader{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
.playLeft{ display:flex; flex-direction:column; gap:6px; min-width:0; }
.playRight{ display:flex; align-items:center; gap:10px; flex:0 0 auto; }

.turnName{
  font-size: 34px;
  font-weight: 1000;
  line-height: 1.02;
  letter-spacing:-0.8px;
}
.turnNameWrap{
  display:flex;
  align-items:center;
  gap:10px;
  min-width:0;
}
.turnBadge{
  display:inline-flex; align-items:center; gap:8px;
  padding: 6px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.16);
  background: linear-gradient(135deg, rgba(255,209,102,0.16), rgba(255,75,216,0.10));
  box-shadow: 0 0 22px rgba(255,209,102,0.10), 0 0 22px rgba(255,75,216,0.10);
  font-weight: 950;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.9px;
}
.turnBadge .bolt{
  width:10px;height:10px;border-radius:3px;
  background: linear-gradient(180deg, var(--accent4), var(--accent3));
  box-shadow: 0 0 10px rgba(255,209,102,0.35);
}

@keyframes turnPulse {
  0%,100% { transform: translateZ(0); filter: brightness(1); }
  50% { transform: translateZ(0); filter: brightness(1.18); }
}
.turnPulse { animation: turnPulse 1.15s ease-in-out infinite; }

.targetLine{
  font-size: 16px;
  font-weight: 850;
  color: #dbeeff;
  opacity: 0.96;
}
.targetValue{
  padding: 2px 10px;
  border-radius: 12px;
  background: linear-gradient(135deg, rgba(89,178,255,0.20), rgba(155,107,255,0.16));
  border: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 0 18px rgba(89,178,255,0.16);
}
.targetValue b{
  background: linear-gradient(90deg, var(--accent) 0%, var(--accent2) 45%, var(--accent3) 90%);
  -webkit-background-clip:text; background-clip:text; color: transparent;
  text-shadow: 0 2px 0 rgba(0,0,0,0.55);
}

.darts{
  display:flex; gap:8px; align-items:center;
}
.dartDot{
  width:34px; height:34px;
  border-radius: 12px;
  display:flex; align-items:center; justify-content:center;
  font-weight: 950;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  color: rgba(234,242,255,0.75);
  box-shadow: 0 10px 20px rgba(0,0,0,0.22);
}
.dartDot.on{
  background: linear-gradient(135deg, rgba(89,178,255,0.30), rgba(155,107,255,0.22));
  color: #ffffff;
  border-color: rgba(89,178,255,0.60);
  box-shadow: 0 0 18px rgba(89,178,255,0.22), 0 0 18px rgba(155,107,255,0.18);
}
.dartDot.done{
  background: rgba(43,213,118,0.12);
  border-color: rgba(43,213,118,0.25);
  color: rgba(234,242,255,0.88);
}

/* Auth hero */
.authHero{
  text-align:center;
  padding: 6px 2px 0;
}
.authTitle{
  font-size: 38px;
  font-weight: 1000;
  letter-spacing: -1.2px;
  margin: 0 0 6px;
}
.authTag{
  font-size: 13px;
  font-weight: 850;
  letter-spacing: 1.2px;
  text-transform: uppercase;
  color: rgba(255,255,255,0.85);
  background: linear-gradient(90deg, rgba(255,209,102,0.22), rgba(255,75,216,0.16), rgba(89,178,255,0.20));
  display:inline-block;
  padding: 6px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 0 22px rgba(255,209,102,0.10), 0 0 22px rgba(255,75,216,0.10);
}
</style>
</head>

<body>
<div class="topbar">
  <div class="brand">
    <div class="t" id="brandTitle">Game Night</div>
    <div class="s" id="brandSub">Designed & Developed by Steve’s Graphic Designs</div>
  </div>
  <div style="display:flex; gap:10px;">
    <button class="btn ghost" id="homeBtn">Home</button>
    <button class="btn ghost" id="signOutBtn" style="display:none;">Sign Out</button>
  </div>
</div>

<div class="wrap" id="app">
  <div class="card"><div class="h1">Initialising...</div></div>
</div>

<script>
/* FULL ENGINE RESTORED & REPAIRED */
function loadScript(src){
  return new Promise((resolve,reject)=>{
    const s=document.createElement("script"); s.src=src; s.async=true;
    s.onload=resolve; s.onerror=()=>reject(new Error("Failed: "+src));
    document.head.appendChild(s);
  });
}
function esc(s){ return String(s??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"); }
function normEmail(e){ return String(e??"").trim().toLowerCase(); }
function now(){ return Date.now(); }

const appEl=document.getElementById("app");
const homeBtn=document.getElementById("homeBtn");
const signOutBtn=document.getElementById("signOutBtn");

const BOARD_NUMS=[20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5];
function polar(cx,cy,r,deg){ const rad=(deg-90)*Math.PI/180; return {x:cx+r*Math.cos(rad), y:cy+r*Math.sin(rad)}; }
function arcWedgePath(cx,cy,r0,r1,a0,a1){
  const p1=polar(cx,cy,r1,a0), p2=polar(cx,cy,r1,a1), p3=polar(cx,cy,r0,a1), p4=polar(cx,cy,r0,a0);
  const large=(a1-a0)>180?1:0;
  const f=n=>(Math.round(n*1000)/1000).toFixed(3);
  return `M ${f(p1.x)} ${f(p1.y)} A ${r1} ${r1} 0 ${large} 1 ${f(p2.x)} ${f(p2.y)} L ${f(p3.x)} ${f(p3.y)} A ${r0} ${r0} 0 ${large} 0 ${f(p4.x)} ${f(p4.y)} Z`;
}

function dartboardSVG(activeTarget){
  const cx=100,cy=100, outer=85, rDoubleOuter=78, rDoubleInner=70, rTripleOuter=52, rTripleInner=44, rSingleInner=14;
  const seg=360/20, rot=-seg/2;
  let activeOverlay="";
  if(typeof activeTarget==="number"){
    const idx=BOARD_NUMS.indexOf(activeTarget);
    if(idx>=0){
      const a0=idx*seg+rot+1; const a1=(idx+1)*seg+rot-1;
      activeOverlay=`<path class="hotWedge" d="${arcWedgePath(cx,cy,rTripleOuter,rDoubleInner,a0,a1)}" fill="url(#aG)" opacity="0.95"/>`;
    }
  }
  if(activeTarget==="B") activeOverlay=`<circle class="hotWedge" cx="100" cy="100" r="12" fill="url(#aG)" opacity="0.95" />`;

  return `<svg viewBox="0 0 200 200" width="280" aria-label="dartboard">
    <defs>
      <linearGradient id="aG" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0" stop-color="#59b2ff"/>
        <stop offset="0.55" stop-color="#9b6bff"/>
        <stop offset="1" stop-color="#ff4bd8"/>
      </linearGradient>
    </defs>
    <circle cx="100" cy="100" r="${outer}" fill="#0b1a2e" stroke="#2a3f5f" stroke-width="2" />
    ${activeOverlay}
    <circle cx="100" cy="100" r="10" fill="#2aa84a" />
    <circle cx="100" cy="100" r="5" fill="#c63a3a" />
  </svg>`;
}

async function boot(){
  try{
    await loadScript("https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js");
    await loadScript("https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js");
    await loadScript("https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js");
    startApp();
  }catch(err){ appEl.innerHTML=`<div class="card">Fatal Error: ${esc(err.message)}</div>`; }
}

function startApp(){
  const firebaseConfig = {
    apiKey: "AIzaSyCY3hTUNNlV6gAofPXY9BVGKb930WYz5RA",
    authDomain: "gamenightdarts-e7601.firebaseapp.com",
    projectId: "gamenightdarts-e7601",
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  let meUser = null;
  let screen = "auth";
  let match = null;
  let activeGameId = null;

  /* --- Repaired Game Module --- */
  const ShanghaiGame = {
    TARGETS: [20,19,18,17,16,15,"B"],
    initMatch: (players) => {
        const m = { gameId: "shanghai", players: players.map(p => ({...p, total: 0})), turnIndex:0, targetIndex:0, dartInTurn:0, grid:{}, finished:false };
        players.forEach(p => {
            m.grid[p.email] = {};
            ShanghaiGame.TARGETS.forEach(t => m.grid[p.email][t]={throws:[], pts:0});
        });
        return m;
    }
  };

  async function render(){
    appEl.innerHTML = "";
    if(screen==="auth") renderAuth();
    else if(screen==="home") renderHome();
    else if(screen==="game.setup") renderSetup();
    else if(screen==="game.play") renderPlay();
  }

  /* expose safe navigation for inline handlers (visual-only update, no mechanics change) */
  window.goHome = () => { screen="home"; render(); };

  function renderAuth(){
    signOutBtn.style.display="none";
    appEl.innerHTML = `
      <div class="card">
        <div class="authHero">
          <div class="authTag">The Dart Room Presents</div>
          <div class="authTitle gradText emboss">Game Night</div>
          <div class="sub" style="margin-top:6px">Designed & Developed by Steve’s Graphic Designs</div>
        </div>

        <div style="margin-top:18px">
          <label style="display:block; text-align:left; font-size:11px; font-weight:900; color:var(--muted); text-transform:uppercase; letter-spacing:1.2px;">Player Email</label>
          <input id="emailIn" type="email" placeholder="Enter your email">
          <button class="btn ok" id="loginBtn" style="width:100%; margin-top:14px;">Enter the Room</button>
        </div>
      </div>`;
    document.getElementById("loginBtn").onclick = async () => {
        const email = normEmail(document.getElementById("emailIn").value);
        if(!email) return;
        const doc = await db.collection("players").doc(email).get();
        meUser = doc.exists ? doc.data() : { email, name: email.split('@')[0] };
        if(!doc.exists) await db.collection("players").doc(email).set(meUser);
        screen="home"; render();
    };
  }

  async function renderHome(){
    signOutBtn.style.display="inline-block";
    appEl.innerHTML = `
      <div class="card">
        <div class="h1 gradText emboss">Welcome, ${esc(meUser.name)}</div>
        <div class="sub">${esc(meUser.email)}</div>
      </div>

      <div class="gameGrid">
        <div class="gameCard">
            <div class="pill"><span class="dot"></span> Active</div>
            <h3 class="emboss" style="margin:12px 0 8px; font-size:20px; letter-spacing:-0.3px;">Shanghai</h3>
            <p class="sub" style="margin-bottom:14px">Sequential targets 20 to Bull. High score wins.</p>
            <button class="btn ok" onclick="window.toSetup('shanghai')" style="width:100%">Start Match</button>
        </div>

        <div class="gameCard">
            <div class="pill"><span class="dot"></span> Active</div>
            <h3 class="emboss" style="margin:12px 0 8px; font-size:20px; letter-spacing:-0.3px;">Killer</h3>
            <p class="sub" style="margin-bottom:14px">Claim a number. Hit doubles to take opponent lives.</p>
            <button class="btn ok" onclick="window.toSetup('killer')" style="width:100%">Start Match</button>
        </div>
      </div>`;
  }

  window.toSetup = (id) => { activeGameId=id; screen="game.setup"; render(); };

  async function renderSetup(){
    const players = (await db.collection("players").get()).docs.map(d => d.data());
    appEl.innerHTML = `
      <div class="card">
        <div class="h1 gradText emboss">Setup ${esc(activeGameId).toUpperCase()}</div>
        <div class="sub">Tap a player to challenge them</div>

        <div class="rosterGrid" style="margin-top:14px">
            ${players.map(p => `
                <div class="gameCard" style="cursor:pointer" onclick="window.startWith('${esc(p.email)}')">
                    <strong class="emboss" style="font-size:16px">${esc(p.name)}</strong><br>
                    <small style="color:var(--muted); font-weight:700">${esc(p.email)}</small>
                </div>
            `).join('')}
        </div>

        <div style="margin-top:12px">
          <button class="btn ghost" onclick="window.goHome()" style="width:100%">Back</button>
        </div>
      </div>`;
  }

  window.startWith = (email) => {
    match = {
        gameId: activeGameId,
        players: [meUser, {name: "Guest", email: "guest@example.com"}],
        turnIndex: 0, targetIndex: 0, dartInTurn: 0, finished: false
    };
    screen="game.play"; render();
  };

  function renderPlay(){
    const p = match.players[match.turnIndex];
    const targets = ShanghaiGame.TARGETS;
    const t = targets[match.targetIndex];

    const d = match.dartInTurn; // 0,1,2

    appEl.innerHTML = `
      <div class="card">
        <div class="playHeader">
          <div class="playLeft">
            <div class="turnNameWrap">
              <div class="turnBadge"><span class="bolt"></span> LIVE</div>
              <div class="pill" style="gap:10px"><span class="dot"></span> ${esc(match.gameId)}</div>
            </div>

            <div class="turnName gradText emboss turnPulse">${esc(p.name)}</div>

            <div class="targetLine emboss">
              Target:
              <span class="targetValue"><b>${esc(t)}</b></span>
            </div>
          </div>

          <div class="playRight">
            <div class="darts" aria-label="dart count">
              <div class="dartDot ${d===0?'on':(d>0?'done':'')}">1</div>
              <div class="dartDot ${d===1?'on':(d>1?'done':'')}">2</div>
              <div class="dartDot ${d===2?'on':''}">3</div>
            </div>
          </div>
        </div>

        <div style="display:flex; justify-content:center; margin:18px 0 6px;">
          ${dartboardSVG(t)}
        </div>

        <div class="hitRow">
            <button class="hitBtn" onclick="window.doHit(1)">Single</button>
            <button class="hitBtn" onclick="window.doHit(2)">Double</button>
            <button class="hitBtn" onclick="window.doHit(3)">Triple</button>
            <button class="hitBtn miss" onclick="window.doHit(0)">Miss</button>
        </div>
      </div>

      <button class="btn ghost" onclick="window.goHome()" style="width:100%">Quit Game</button>`;
  }

  window.doHit = (val) => {
    match.dartInTurn++;
    if(match.dartInTurn >= 3){
        match.dartInTurn = 0;
        match.turnIndex = (match.turnIndex + 1) % match.players.length;
        if(match.turnIndex === 0) match.targetIndex++;
    }
    if(match.targetIndex >= 7) {
      alert("Match Complete!");
      screen="home";
    }
    render();
  };

  homeBtn.onclick = () => { if(meUser){ screen="home"; render(); } else { screen="auth"; render(); } };
  signOutBtn.onclick = () => { meUser=null; screen="auth"; render(); };
  render();
}
boot();
</script>
</body>
</html>
